<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://telegram.org"></script>
    <style>
        :root { --accent: #ff9500; --bg: #0d0d0f; --glass: rgba(255, 255, 255, 0.05); }
        body { 
            background: var(--bg); color: white; font-family: -apple-system, sans-serif;
            display: flex; flex-direction: column; align-items: center; margin: 0; padding: 10px;
            user-select: none; overflow-x: hidden; min-height: 100vh;
        }

        /* –í–∏–∑—É–∞–ª—å–Ω—ã–π –ö–æ—Ç */
        .cat-avatar { font-size: 60px; margin: 10px 0; transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        /* –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è */
        .achievements { display: flex; gap: 8px; margin-bottom: 15px; overflow-x: auto; width: 100%; padding: 5px; }
        .ach-icon { 
            min-width: 40px; height: 40px; background: var(--glass); border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; font-size: 18px; 
            border: 1px solid rgba(255,255,255,0.1); filter: grayscale(1); opacity: 0.4;
        }
        .ach-active { filter: grayscale(0); opacity: 1; border-color: var(--accent); box-shadow: 0 0 10px var(--accent); }

        /* –û—Ä–∞–∫—É–ª */
        .oracle-box {
            width: 90%; background: linear-gradient(45deg, #1a1a1c, #252528);
            border-radius: 20px; padding: 15px; margin-bottom: 20px; border: 1px solid #333;
            text-align: center; position: relative;
        }
        .oracle-tag { position: absolute; top: -10px; left: 20px; background: var(--accent); color: black; font-size: 10px; font-weight: bold; padding: 2px 8px; border-radius: 5px; }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –±–ª–æ–∫ */
        .main-card {
            width: 100%; max-width: 340px; background: var(--glass); border-radius: 30px;
            padding: 20px; border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(15px);
            text-align: center; position: relative; overflow: hidden;
        }
        #laser { position: absolute; left: 0; width: 100%; height: 2px; background: var(--accent); box-shadow: 0 0 15px var(--accent); display: none; }
        @keyframes scanAnim { 0% { top: 0%; } 100% { top: 100%; } }

        .trust-bar { width: 100%; height: 6px; background: #222; border-radius: 10px; margin: 10px 0; overflow: hidden; }
        #trust-fill { width: 50%; height: 100%; background: linear-gradient(90deg, #ff4d4d, var(--accent), #4aff4a); transition: 1s; }

        .big-btn { width: 85px; height: 85px; border-radius: 50%; border: none; background: linear-gradient(135deg, #ff9500, #ff5e00); font-size: 35px; cursor: pointer; box-shadow: 0 5px 20px rgba(255,149,0,0.3); margin-top: 10px; }
        
        .diary-box { width: 100%; max-width: 340px; margin-top: 15px; background: rgba(255,255,255,0.02); border-radius: 15px; padding: 12px; height: 100px; overflow-y: auto; font-size: 12px; }
    </style>
</head>
<body>

    <div class="cat-avatar" id="cat-face">üòº</div>

    <div class="achievements">
        <div class="ach-icon" id="ach-1" title="–ü–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç">ü§ù</div>
        <div class="ach-icon" id="ach-2" title="–°—ã—Ç—ã–π –∫–æ—Ç">ü•£</div>
        <div class="ach-icon" id="ach-3" title="–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫">üìö</div>
        <div class="ach-icon" id="ach-4" title="–õ—É—á—à–∏–π –¥—Ä—É–≥">üíé</div>
    </div>

    <div class="oracle-box" onclick="getPrediction()">
        <div class="oracle-tag" id="trial-tag">TRIAL: –î–ï–ù–¨ 1/7</div>
        <div style="font-size: 11px; opacity: 0.6; margin-bottom: 5px;">–ï–ñ–ï–î–ù–ï–í–ù–´–ô –û–†–ê–ö–£–õ –ú–Ø–£</div>
        <div id="oracle-text" style="font-weight: bold; color: #ffcc00; font-size: 14px;">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —Å—É–¥—å–±—É</div>
    </div>

    <div class="main-card">
        <div id="laser"></div>
        <div style="font-size: 10px; display: flex; justify-content: space-between;"><span>–î–û–í–ï–†–ò–ï</span><span id="trust-pct">50%</span></div>
        <div class="trust-bar"><div id="trust-fill"></div></div>

        <div id="status" style="font-size: 16px; min-height: 40px; margin: 10px 0; color: #eee;">–ì–æ—Ç–æ–≤ –∫ —Å–≤—è–∑–∏</div>
        <button class="big-btn" id="btn" onclick="startScan()">üêæ</button>
    </div>

    <div class="diary-box" id="diary-list">
        <div style="opacity: 0.3; text-align: center;">–ò—Å—Ç–æ—Ä–∏—è –º—ã—Å–ª–µ–π –ø—É—Å—Ç–∞</div>
    </div>

    <div style="margin-top: 15px; display: flex; gap: 10px;">
        <button onclick="playEffect('can')" style="background:var(--glass); border:1px solid #444; color:white; padding:8px 12px; border-radius:12px; font-size:11px;">ü•´ –ë–ê–ù–ö–ê</button>
        <button onclick="playEffect('pouch')" style="background:var(--glass); border:1px solid #444; color:white; padding:8px 12px; border-radius:12px; font-size:11px;">üõçÔ∏è –ü–ê–ö–ï–¢</button>
    </div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    let trust = 50;
    let scansCount = 0;
    let trialDay = 1;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    const predictions = [
        "–°–µ–≥–æ–¥–Ω—è –º–∏—Å–∫–∞ –±—É–¥–µ—Ç –ø–æ–ª–Ω–∞, –∞ –∫–æ–∂–∞–Ω—ã–π –ø–æ—Å–ª—É—à–µ–Ω.",
        "–ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–µ–Ω —Å –∫–∞–∫—Ç—É—Å–æ–º ‚Äî –æ–Ω –º–æ–∂–µ—Ç –¥–∞—Ç—å —Å–¥–∞—á—É.",
        "–í—Ä–µ–º—è –¥–ª—è —Ç—ã–≥-–¥—ã–∫–∞ –Ω–∞—Å—Ç–∞–Ω–µ—Ç –≤ 3 —á–∞—Å–∞ –Ω–æ—á–∏. –ì–æ—Ç–æ–≤—å—Å—è.",
        "–ó–≤–µ–∑–¥—ã —Å—É–ª—è—Ç —Ç–µ–±–µ –ª–∏—à–Ω—é—é –ø–æ—Ä—Ü–∏—é –ø–∞—à—Ç–µ—Ç–∞.",
        "–ö—Ç–æ-—Ç–æ –ø–æ—á–µ—à–µ—Ç —Ç–µ–±—è –∑–∞ —É—à–∫–æ–º, –Ω–µ –∫—É—Å–∞–π –µ–≥–æ (—Å–∏–ª—å–Ω–æ)."
    ];

    function startScan() {
        if(trust < 15) return tg.showAlert("–ö–æ—Ç –≤ —è—Ä–æ—Å—Ç–∏ üòø –ù–∞–∫–æ—Ä–º–∏ –µ–≥–æ!");
        
        animateProcess(2000, ["–°—á–∏—Ç—ã–≤–∞–Ω–∏–µ...", "–ê–Ω–∞–ª–∏–∑..."], () => {
            const res = (trust > 60) ? 
                ["–õ—é–±–∏–º—ã–π —Ö–æ–∑—è–∏–Ω... ‚ù§Ô∏è", "–ú—Ä—Ä—Ä-–º—è—É! ‚ú®", "–¢—ã –ª—É—á—à–∏–π –∏–∑ –ª—é–¥–µ–π."][Math.floor(Math.random()*3)] : 
                ["–ì–¥–µ –µ–¥–∞? üòæ", "–ö—É—Å—å –Ω–µ–º–∏–Ω—É–µ–º!", "–û—Ç–æ–π–¥–∏, –∫–æ–∂–∞–Ω—ã–π."][Math.floor(Math.random()*3)];
            
            document.getElementById('status').innerText = res;
            scansCount++;
            trust = Math.max(5, trust - 10);
            checkAchievements();
            updateUI();
            addToDiary(res);
        });
    }

    function getPrediction() {
        if(trialDay > 7) {
            tg.showConfirm("–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –æ–∫–æ–Ω—á–µ–Ω. –ü—Ä–æ–¥–ª–∏—Ç—å –û—Ä–∞–∫—É–ª –∑–∞ ‚≠êÔ∏è 3/–º–µ—Å?", (ok) => {});
            return;
        }
        tg.HapticFeedback.impactOccurred('medium');
        document.getElementById('oracle-text').innerText = predictions[Math.floor(Math.random()*predictions.length)];
        tg.showAlert("–û—Ä–∞–∫—É–ª –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª —Å—É–¥—å–±—É!");
    }

    function checkAchievements() {
        if(scansCount >= 1) document.getElementById('ach-1').classList.add('ach-active');
        if(trust >= 90) document.getElementById('ach-2').classList.add('ach-active');
        if(scansCount >= 10) document.getElementById('ach-3').classList.add('ach-active');
    }

    function animateProcess(dur, steps, cb) {
        const laser = document.getElementById('laser');
        const status = document.getElementById('status');
        laser.style.display = 'block';
        laser.style.animation = `scanAnim 1s infinite linear`;
        
        let sIdx = 0;
        const intrvl = setInterval(() => {
            if(sIdx < steps.length) status.innerText = steps[sIdx++];
            tg.HapticFeedback.impactOccurred('light');
        }, dur/steps.length);

        setTimeout(() => {
            clearInterval(intrvl);
            laser.style.display = 'none';
            cb();
            tg.HapticFeedback.notificationOccurred('success');
        }, dur);
    }

    function playEffect(t) {
        tg.HapticFeedback.impactOccurred('medium');
        if(t === 'can') { beep(700, 'square', 0.05); setTimeout(()=>beep(400, 'sine', 0.2), 100); }
        else { makeNoise(0.6); }
        trust = Math.min(100, trust + 20);
        updateUI();
    }

    function updateUI() {
        const fill = document.getElementById('trust-fill');
        const face = document.getElementById('cat-face');
        fill.style.width = trust + "%";
        document.getElementById('trust-pct').innerText = trust + "%";
        
        if(trust < 30) { face.innerText = "üòø"; fill.style.background = "#ff4d4d"; }
        else if(trust > 75) { face.innerText = "üòá"; fill.style.background = "#4aff4a"; }
        else { face.innerText = "üòº"; fill.style.background = "var(--accent)"; }
    }

    function addToDiary(msg) {
        const list = document.getElementById('diary-list');
        if(list.innerText.includes("–ò—Å—Ç–æ—Ä–∏—è –º—ã—Å–ª–µ–π –ø—É—Å—Ç–∞")) list.innerHTML = "";
        const div = document.createElement('div');
        div.style.marginBottom = "5px";
        div.innerText = `> ${msg}`;
        list.prepend(div);
    }

    function beep(f, t, d) {
        const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
        o.type = t; o.frequency.value = f; o.connect(g); g.connect(audioCtx.destination);
        o.start(); g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + d); o.stop(audioCtx.currentTime + d);
    }

    function makeNoise(d) {
        const b = audioCtx.createBuffer(1, audioCtx.sampleRate * d, audioCtx.sampleRate);
        const data = b.getChannelData(0);
        for (let i = 0; i < b.length; i++) data[i] = Math.random() * 2 - 1;
        const s = audioCtx.createBufferSource(); s.buffer = b;
        const f = audioCtx.createBiquadFilter(); f.type = 'highpass'; f.frequency.value = 1500;
        s.connect(f); f.connect(audioCtx.destination); s.start();
    }

    updateUI();
</script>
</body>
</html>
