<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <script src="https://telegram.org"></script>
    <style>
        :root { 
            --accent: #ff9500; 
            --gold: #ffd700;
            --bg: #08080a;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
        }

        * { -webkit-touch-callout: none; user-select: none; box-sizing: border-box; outline: none; transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1); }

        body { 
            background: var(--bg); color: white;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
            display: flex; flex-direction: column; align-items: center; margin: 0; padding: 20px;
            min-height: 100vh; overflow-x: hidden;
        }

        /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∂–∏–≤–æ–π —Ñ–æ–Ω (Aurora) */
        .aurora {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 20% 30%, rgba(255, 149, 0, 0.15), transparent 40%),
                        radial-gradient(circle at 80% 70%, rgba(51, 144, 236, 0.1), transparent 40%);
            filter: blur(80px); z-index: -1; animation: auroraFlow 20s infinite alternate;
        }
        @keyframes auroraFlow { 0% { transform: scale(1); } 100% { transform: scale(1.2); } }

        .glass-card {
            width: 100%; max-width: 400px; background: var(--glass);
            backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
            border: 1px solid var(--border); border-radius: 35px;
            padding: 25px; margin-bottom: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .setup-screen { text-align: center; margin-top: 12vh; animation: slideUp 0.8s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        h1 { font-size: 32px; font-weight: 800; letter-spacing: -1.5px; margin-bottom: 10px; background: linear-gradient(180deg, #fff 0%, #888 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        input, select {
            width: 100%; background: rgba(255,255,255,0.05); border: 1px solid var(--border);
            color: white; padding: 18px; border-radius: 22px; font-size: 16px; margin-bottom: 15px;
        }

        .btn-prime {
            background: linear-gradient(135deg, #ff9500, #ff5e00); color: white;
            border: none; padding: 20px; border-radius: 24px; font-weight: 800;
            width: 100%; cursor: pointer; text-transform: uppercase; letter-spacing: 2px;
            box-shadow: 0 10px 30px rgba(255, 149, 0, 0.3);
        }
        .btn-prime:active { transform: scale(0.95); filter: brightness(1.1); }

        .cat-hero { font-size: 90px; filter: drop-shadow(0 0 20px rgba(255,255,255,0.2)); margin: 20px 0; display: inline-block; }
        .is-talking { animation: catBounce 0.3s infinite; }
        @keyframes catBounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1) rotate(3deg); } }

        /* –¢—Ä–µ–∫–µ—Ä */
        .chart-wrap { background: rgba(0,0,0,0.3); border-radius: 24px; padding: 20px; margin: 15px 0; border: 1px solid var(--border); }
        .chart { width: 100%; height: 60px; display: flex; align-items: flex-end; gap: 8px; }
        .bar { flex: 1; background: var(--accent); border-radius: 6px; min-height: 4px; box-shadow: 0 0 15px rgba(255,149,0,0.3); }

        /* –ö–Ω–æ–ø–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ */
        .tool-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 20px; }
        .tool { background: var(--glass); border: 1px solid var(--border); border-radius: 25px; padding: 20px 10px; text-align: center; cursor: pointer; }
        .tool:active { background: var(--accent); }
        .tool span { font-size: 28px; display: block; margin-bottom: 5px; }

        #scanner-line { 
            position: absolute; left: 0; width: 100%; height: 4px; 
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            box-shadow: 0 0 25px var(--accent); display: none; z-index: 10;
        }
        @keyframes scanning { 0% { top: 0%; } 100% { top: 100%; } }

        .app-screen { display: none; width: 100%; max-width: 400px; animation: slideUp 0.6s ease; }
    </style>
</head>
<body>
    <div class="aurora"></div>

    <!-- START SCREEN -->
    <div id="setup" class="glass-card setup-screen">
        <div class="cat-hero">üòº</div>
        <h1>MEOWVIBE PRO</h1>
        <p style="opacity: 0.5; font-size: 14px; margin-bottom: 30px;">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–∑–Ω–∞–Ω–∏—è —Å –≤–∞—à–∏–º –ø–∏—Ç–æ–º—Ü–µ–º</p>
        <input type="text" id="cat-name" placeholder="–ò–º—è –ø–∏—Ç–æ–º—Ü–∞" maxlength="10">
        <select id="cat-age">
            <option value="kitten">–ö–æ—Ç—ë–Ω–æ–∫ (High Pitch)</option>
            <option value="adult" selected>–í–∑—Ä–æ—Å–ª—ã–π –∫–æ—Ç (Middle)</option>
            <option value="senior">–ú—É–¥—Ä—ã–π –∫–æ—Ç (Deep)</option>
        </select>
        <button class="btn-prime" onclick="startApp()">–°–û–ó–î–ê–¢–¨ –°–í–Ø–ó–¨</button>
    </div>

    <!-- MAIN APP -->
    <div id="app" class="app-screen">
        <div class="glass-card" style="text-align: center; position: relative; overflow: hidden;">
            <div id="cat-face" class="cat-hero">üòº</div>
            <div id="display-name" style="font-size: 34px; font-weight: 900; letter-spacing: -1px; color: var(--accent);">–ö–û–¢</div>
            <div class="chart-wrap">
                <div class="chart" id="mood-chart"></div>
                <div style="font-size: 10px; opacity: 0.4; letter-spacing: 3px; margin-top: 15px; font-weight: bold;">NEURAL MOOD TRACKER</div>
            </div>
        </div>

        <div class="glass-card">
            <div style="font-size: 11px; font-weight: 800; color: var(--accent); margin-bottom: 15px; letter-spacing: 1px;">SENSORY TRANSLATOR AI</div>
            <input type="text" id="user-msg" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ—Ä–∞–∑—É...">
            <button class="btn-prime" onclick="aiTranslate()">–ì–û–í–û–†–ò–¢–¨ –° –ö–û–¢–û–ú</button>
        </div>

        <div class="glass-card" style="position: relative; overflow: hidden; text-align: center;">
            <div id="scanner-line"></div>
            <div id="status" style="font-weight: 800; opacity: 0.5; font-size: 12px; margin-bottom: 10px;">BIO-SCANNER ACTIVE</div>
            <button onclick="runBioScan()" style="background:none; border:none; font-size:80px; cursor:pointer; filter: drop-shadow(0 0 15px var(--accent));">üêæ</button>
            
            <div class="tool-grid">
                <div class="tool" onclick="fx('magnet')"><span>üîî</span><small>–ú–ê–ì–ù–ò–¢</small></div>
                <div class="tool" onclick="fx('stop')"><span>üö´</span><small>–°–¢–û–ü</small></div>
                <div class="tool" onclick="fx('purr')"><span>üí§</span><small>–ú–£–†</small></div>
            </div>
        </div>

        <button class="btn-prime" style="background: rgba(255,255,255,0.05); box-shadow: none; border: 1px solid var(--border); margin-bottom: 50px;" onclick="refShare()">üéÅ –ü–†–ò–ì–õ–ê–°–ò–¢–¨ –î–†–£–ì–ê (+5 –ë–û–ù–£–°–û–í)</button>
    </div>

<script>
    const tg = window.Telegram?.WebApp || null;
    let audio = null;
    let state = { name: "", age: "adult", mood: };

    function startApp() {
        state.name = document.getElementById('cat-name').value || "–ö–æ—Ç";
        state.age = document.getElementById('cat-age').value;
        document.getElementById('setup').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        document.getElementById('display-name').innerText = state.name.toUpperCase();
        renderMood();
        if(tg) { tg.ready(); tg.expand(); tg.setHeaderColor('#08080a'); }
    }

    function renderMood() {
        const c = document.getElementById('mood-chart'); c.innerHTML = "";
        state.mood.forEach(v => {
            const b = document.createElement('div'); b.className = 'bar';
            b.style.height = v + "%"; c.appendChild(b);
        });
    }

    function initAudio() { if(!audio) audio = new (window.AudioContext || window.webkitAudioContext)(); }

    function synth(f, d, v, type='triangle') {
        initAudio();
        const o = audio.createOscillator(), g = audio.createGain();
        o.type = type;
        o.frequency.setValueAtTime(f, audio.currentTime);
        o.frequency.exponentialRampToValueAtTime(f*1.6, audio.currentTime + d*0.2);
        o.frequency.linearRampToValueAtTime(f*0.8, audio.currentTime + d);
        g.gain.setValueAtTime(0, audio.currentTime);
        g.gain.linearRampToValueAtTime(v, audio.currentTime + 0.05);
        g.gain.exponentialRampToValueAtTime(0.01, audio.currentTime + d);
        o.connect(g); g.connect(audio.destination); o.start(); o.stop(audio.currentTime + d);
    }

    function aiTranslate() {
        const m = document.getElementById('user-msg').value; if(!m) return;
        const words = m.split(' ');
        const face = document.getElementById('cat-face');
        words.forEach((w, i) => {
            setTimeout(() => {
                face.classList.add('is-talking');
                let base = state.age === 'kitten' ? 850 : (state.age === 'senior' ? 300 : 500);
                synth(base + Math.random()*200, 0.4);
                setTimeout(() => face.classList.remove('is-talking'), 300);
            }, i * 500);
        });
    }

    function runBioScan() {
        const l = document.getElementById('scanner-line');
        l.style.display = 'block'; l.style.animation = 'scanning 2s infinite linear';
        let b = 0; const i = setInterval(() => { if(tg) tg.HapticFeedback.impactOccurred('medium'); b++; if(b>10) clearInterval(i); }, 400);
        setTimeout(() => {
            l.style.display = 'none';
            state.mood.shift(); state.mood.push(Math.floor(Math.random()*60)+40);
            renderMood(); if(tg) tg.HapticFeedback.notificationOccurred('success');
        }, 4000);
    }

    function fx(t) {
        if(t === 'magnet') synth(1100, 0.7, 0.3, 'sine');
        if(t === 'stop') synth(150, 0.3, 0.4, 'sawtooth');
        if(t === 'purr') { if(tg) tg.HapticFeedback.impactOccurred('soft'); synth(40, 1.5, 0.2, 'sine'); }
    }

    function refShare() {
        const uid = tg?.initDataUnsafe?.user?.id || "0";
        const url = `https://t.me{uid}&text=–ú–æ–π –∫–æ—Ç –∑–∞–≥–æ–≤–æ—Ä–∏–ª! –ü–æ–ø—Ä–æ–±—É–π –Ω–∞—à –Ω–µ–π—Ä–æ-—Å–∫–∞–Ω–µ—Ä üêæ`;
        if(tg) tg.openTelegramLink(url); else window.open(url);
    }
</script>
</body>
</html>
